!function(a){function b(b,c,d,e){for(var f=a("<select class='form-control'>").attr("name",d[c]),g=0;g<b.length;++g){var h=b[g].id,i=b[g].text,j=a("<option>").attr("value",h).text(i);(void 0!==e&&b[g].id===e[c]||0===g)&&j.prop("selected",!0),f.append(j)}return f}function c(a,b){var c=a.find('select[name="'+b+'"]');c.length>0&&c.nextAll().remove()}function d(e,f){var g=e.elem,h=e.pid,i=e.index,j=e.names,k=e.selected,l=e.fetchCb,m=l(h);if(0===m.length)return void c(g,j[i]);if(void 0!==k||f)var n=b(m,i,j,k);else var n=b(m,i+1,j,k);if(0===h&&void 0===k)g.append(n),d(a.extend(e,{pid:m[0].id,index:i+1}),f);else if(0===h&&void 0!==k)g.append(n),void 0!==k[i+1]&&d(a.extend(e,{pid:k[i],index:i+1}),f);else if(c(g,j[i]),g.append(n),void 0===k)d(a.extend(e,{pid:m[0].id,index:i+1}),f);else{if(void 0===k||void 0===k[i+1])return;d(a.extend(e,{pid:k[i],index:i+1}),f)}}a.fn.chainedSelect=function(b){var c=a(this),e=void 0===c.attr("data-selected")?b.selected:c.attr("data-selected").split("-"),f=void 0===c.attr("data-names")?b.names:c.attr("data-names").split("-"),g={elem:c,names:f,selected:e,fetchCb:b.fetchCb};c.on("change","select",function(){d(a.extend(g,{pid:+a(this).val(),index:a(this).index()}),!1)}),d(a.extend(g,{pid:0,index:0}),!0)}}(jQuery);
